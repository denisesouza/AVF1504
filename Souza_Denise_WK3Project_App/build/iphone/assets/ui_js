var networkLoad=require("network"),osname=Ti.Platform.osname;exports.entryBuild=function(){var e=new dataLoad,t=[{title:"HipHop"},{title:"Covers"},{title:"Rap"},{title:"R&B"},{title:"Pop"},{title:"Rock"},{title:"House"}],a=[{title:"Celine Dion"},{title:"Maroon 5"},{title:"Sam Smith"},{title:"Ed Sheeran"},{title:"Eminem"},{title:"Common"},{title:"2 Chainz"},{title:"Calvin Harris"},{title:"John Legend"}],o=Ti.UI.createWindow({backgroundColor:"#000",fullscreen:!0}),r=Ti.UI.createTextField({top:"30%",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,color:"#336699",width:"45%",height:"5%",hintText:"Enter a artist, genre or keyword to begin search"}),i=Ti.UI.createButton({top:"35%",title:"Search",width:"45%",color:"#000",font:{fontSize:"24dp"},backgroundColor:"#65A4A4"}),n=Ti.UI.createButton({title:"Listen to Favorites",font:{fontSize:"26dp"},top:"50%",width:"50%",color:"#FF6600",borderColor:"#FF6600"}),d=Ti.UI.createLabel({text:"GENRES:",bottom:"32%",font:{fontSize:"18dp"},left:"22%",color:"#FF6600"}),l=Ti.UI.createLabel({text:"MY FAVORITE ARTISTS:",bottom:"32%",font:{fontSize:"18dp"},right:"18%",color:"#FF6600"}),s=Ti.UI.createImageView({height:"20%",top:"3%",image:"images/soundcloud_main.png"}),u=Ti.UI.createTableView({height:"30%",bottom:"1%",right:"51%",left:"2%",backgroundColor:"white",rowHeight:30,seperatorColor:"transparent",data:t}),c=Ti.UI.createTableView({height:"30%",bottom:"1%",left:"51%",right:"2%",backgroundColor:"white",rowHeight:30,seperatorColor:"transparent",data:a}),g="";o.add(l),o.add(d),o.add(r),o.add(i),o.add(n),o.add(s),o.add(c),o.add(u),o.open(),n.addEventListener("click",function(){e.read()}),i.addEventListener("click",function(){""==r.value?alert("Please enter a value to continue!"):(g="http://api.soundcloud.com/tracks.json?&client_id=cc7f901025ad59c9e06ea0f140fd6e58&genres="+r.value,networkLoad.netCheck(g),o.close())}),u.addEventListener("click",function(e){g="http://api.soundcloud.com/tracks.json?&client_id=cc7f901025ad59c9e06ea0f140fd6e58&genres="+e.source.title,networkLoad.netCheck(g),o.close()}),c.addEventListener("click",function(e){g="http://api.soundcloud.com/tracks.json?&client_id=cc7f901025ad59c9e06ea0f140fd6e58&genres="+e.source.title,networkLoad.netCheck(g),o.close()})},exports.playlistBuild=function(e){var t=new dataLoad,a=Titanium.UI.createAnimation();a.left=0,a.duration=300;var o=0,r=e,i=r.length-1,n=Ti.UI.createWindow({backgroundColor:"#000",fullscreen:!0}),d=Ti.Media.createAudioPlayer({url:r[o].stream,allowBackground:!0,preload:!0}),l=Ti.UI.createProgressBar({top:"66%",width:"90%",height:"40dp",min:0,max:r[o].duration/1e3,value:0,tintColor:"#FF6600"}),s=Ti.UI.createButton({bottom:"9%",backgroundImage:"images/pause.png"}),u=Ti.UI.createButton({bottom:"10%",left:"12%",backgroundImage:"images/back.png"}),c=Ti.UI.createButton({top:"1%",width:100,left:"2%",backgroundImage:"images/return.jpeg"}),g=Ti.UI.createButton({title:"ADD TO MY FAVORITES",font:{fontSize:"22dp"},top:"71%",height:"5%",color:"#FF6600"}),p=Ti.UI.createButton({bottom:"10%",right:"12%",backgroundImage:"images/next.png"}),m=Ti.UI.createSlider({bottom:"5%",min:0,max:100,width:"65%",value:80,tintColor:"#FF6600"}),f=Ti.UI.createImageView({height:420,width:420,top:"10%",image:r[o].artwork});console.log(f.image),console.log(r[o].artwork);var T=Ti.UI.createLabel({text:r[o].title,font:{fontFamily:"Roboto",fontSize:"30dp"},color:"#fff",backgroundColor:"#000",top:"55%"}),k=Ti.UI.createLabel({text:r[o].user,font:{fontFamily:"Roboto",fontSize:"20dp"},color:"#fff",backgroundColor:"#000",top:"63%"});d.addEventListener("progress",function(e){l.value=Math.round(e.progress/1e3)}),m.addEventListener("change",function(e){d.volume=e.value/100}),s.addEventListener("click",function(){d.paused?(s.backgroundImage="images/pause.png",d.play()):d.playing&&(s.backgroundImage="images/play.png",d.pause())}),p.addEventListener("click",function(){o>=i?alert("Add more songs to playlist!"):d.playing?"android"==osname?d.release():d.stop():d.paused&&("android"==osname?d.release():(s.backgroundImage="images/pause.png",d.stop()))}),u.addEventListener("click",function(){0===o?u.enabled=!1:d.playing?(o-=2,"android"==osname?d.release():d.stop()):d.paused&&(o-=2,"android"==osname?d.release():(s.backgroundImage="images/pause.png",d.stop()))}),d.addEventListener("change",function(e){Ti.API.info("State: "+e.description+" ("+e.state+")"),0!==o&&(u.enabled=!0)}),g.addEventListener("click",function(){t.create(r[o]),cloudLoad.cloudSave(r[o]),alert(r[o].title+"\nHas been added to your favorites!")}),d.addEventListener("change",function(e){console.log(i,o),o>i&&0==e.state?alert("End of playlist! Continue or exit!"):7===e.state&&o>=0&&i>o?(console.log("SONG COMPLETED!!!"),"android"==osname?d.release():d.stop(),o+=1,d.url=r[o].stream,f.image=r[o].artwork,T.text=r[o].title,k.text=r[o].user,n.remove(f),n.remove(T),n.remove(k),n.add(k),n.add(T),n.add(f),console.log(r[o].artwork),d.play()):7===e.state&&0>=o&&("android"==osname?d.release():d.stop(),o=0,d.url=r[o].stream,f.image=r[o].artwork,T.text=r[o].title,k.text=r[o].user,n.remove(f),n.remove(T),n.remove(k),n.add(k),n.add(T),n.add(f),d.play())}),c.addEventListener("click",function(){"android"==osname?d.release():d.playing&&d.pause(),n.close(),uiLoad.entryBuild()}),r[o].id||n.add(g),Ti.Gesture.addEventListener("orientationchange",function(){console.log(Ti.Gesture.orientation),3==Ti.Gesture.orientation||4==Ti.Gesture.orientation?(f.top="8%",f.width=350,f.height=350):(1==Ti.Gesture.orientation||2==Ti.Gesture.orientation)&&(f.top="10%",f.width=420,f.height=420)}),n.add(f),n.add(m),n.add(l),n.add(k),n.add(T),n.add(c),n.add(p),n.add(u),n.add(s),n.add(d),n.open(a),d.start(),l.show()};