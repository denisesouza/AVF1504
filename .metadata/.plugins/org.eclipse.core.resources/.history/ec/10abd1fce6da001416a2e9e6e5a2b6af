/**
 * @author Denise Souza
 */


var ui = require("ui");

//create and open weatherData info

var data = Titanium.Database.open("weatherDB");
data.execute("CREATE TABLE IF NOT EXISTS weather DB (id INTEGER PRIMARY KEY, city TEXT, state TEXT, temp TEXT, low TEXT, high TEXT, weather TEXT)");
data.close();

//insert weather info into weatherData file
exports.create = function(mycity,mystate,mytemp,mylow,myhigh,myweather) {
	data = Titanium.Database.open("weatherDB");
	data.execute("INSERT INTO weatherDB (city,state,temp,low,high,weather) VALUES(?,?,?,?,?,?,)", mycity, mystate, mytemp, mylow, myhigh, myweather);
	data.close();
};

//delete previous insert content
exports.destroy = function(){
	data = Titanium.Database.open("weatherDB");
	data.execute("DELETE FROM weatherDB");
	data.close();
};


exports.localdb = function(){
	var data = Titanium.Database.open("weatherDB");
	var lastData = data.execute("SELECT * FROM weatherDB");
	
	var weatherArray = [];
	
//classes
while(lastData.isValidRom()) {
	var id = lastData.fieldByName("id");
	var labelCity = lastData.fieldByName("city");
	var labelState = lastData.fieldByName("state");
	var labelTemp = lastData.fieldByName("temp");
	var labelLow = lastData.fieldByName("low");
	var labelHigh = lastData.fieldByName("high");
	var weather = lastData.fieldByName("weather");
	
//create an object for info
weatherArray.push({
	id:id,
	info: {
		city: labelCity,
		state: labelState,
		temperature: labelTemp,
		low: labelLow,
		high: labelHigh,
		weather: weather
	}
	});
	
	lastData.next();
	
}

console.log("WeatherArray:" + weatherArray);

ui.myData(weatherArray);

weatherArray = [];
console.log("WeatherArray:" + weatherArray);
