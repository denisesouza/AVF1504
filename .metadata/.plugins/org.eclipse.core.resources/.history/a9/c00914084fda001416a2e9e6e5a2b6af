/**
 * @author Denise Souza
 */

var weatherData = require("weatherData");
exports.data = function(lat,long) {
	
	if (Ti.Network.online === true) {
		var url = "http://api.wunderground.com/weather/api/8ad159642a519b70/conditions/q/“ + lat + “ , “ + lng + “.json”;
		
		var remoteResponse = function() {
			var json = JSON.parse(this.responseText); //converting string to JSON object 
			console.log(json);
			
			weatherData.create(json.current_observation_location.full, json.current_observation.observation_location.city, json.current_observation.observation_location.state, json.current_observation.observation_location.latitude, json.current_observation.observation_location.longitude);
			
			weatherData.localdb();
		};
		
		
var xhr = Ti.Network.createHTTPClient({
	onload: remoteResponse,
	onerror: function(){
		
		if (Titanium.Network.networkType === Titanium.Network.NETWORK_NONE) {
			alert ("Network is currently unavailable.");
			table.setData(local.localdb());
			
		} else {
			alert ("A Network Error has occured!");
		}
		},
			timeout: 5000
	});
	
	xhr.open("GET", url);
	xhr.send();
	
} else {
	alert("Network is currently unavailable");
	
	weatherData.localdb();
			
		}
};

