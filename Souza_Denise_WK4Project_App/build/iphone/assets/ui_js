var networkLoad=require("network"),osname=Ti.Platform.osname;exports.entryBuild=function(){var e=new dataLoad,t=[{title:"HipHop"},{title:"Covers"},{title:"Rap"},{title:"R&B"},{title:"Pop"},{title:"Rock"},{title:"House"},{title:"Jazz"},{title:"Blues"},{title:"Folk"},{title:"Country"}],a=[{title:"Celine Dion"},{title:"Maroon 5"},{title:"Sam Smith"},{title:"Ed Sheeran"},{title:"Eminem"},{title:"Common"},{title:"2 Chainz"},{title:"Calvin Harris"},{title:"John Legend"}],o=Ti.UI.createWindow({backgroundColor:"#000",fullscreen:!0}),i=Ti.UI.createTextField({top:"30%",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,color:"#336699",width:"45%",height:"5%",hintText:"Enter a artist, genre or keyword to begin search"}),r=Ti.UI.createButton({top:"35%",title:"Search",width:"45%",color:"#000",font:{fontSize:"24dp"},backgroundColor:"#ff5600"}),n=Ti.UI.createButton({title:"Play all Favorites",font:{fontSize:"26dp"},top:"50%",width:"50%",color:"#ff5600",borderColor:"#ff5600"}),d=Ti.UI.createLabel({text:"GENRES:",bottom:"32%",font:{fontSize:"18dp"},left:"2%",color:"#ff5600"}),l=Ti.UI.createLabel({text:"ARTISTS:",bottom:"32%",font:{fontSize:"18dp"},left:"51%",color:"#ff5600"}),s=Ti.UI.createImageView({left:"4%",right:"4%",top:"3%",image:"images/FlutterCloud_logo.png"}),u=Ti.UI.createTableView({height:"30%",bottom:"1%",right:"51%",left:"2%",backgroundColor:"white",rowHeight:30,seperatorColor:"transparent",data:t}),c=Ti.UI.createTableView({height:"30%",bottom:"1%",left:"51%",right:"2%",backgroundColor:"white",rowHeight:30,seperatorColor:"transparent",data:a}),g="";o.add(l),o.add(d),o.add(i),o.add(r),o.add(n),o.add(s),o.add(c),o.add(u),o.open(),n.addEventListener("click",function(){e.read()}),r.addEventListener("click",function(){""==i.value?alert("Please enter a value to continue!"):(g="http://api.soundcloud.com/tracks.json?&client_id=cc7f901025ad59c9e06ea0f140fd6e58&genres="+i.value,networkLoad.netCheck(g),o.close())}),u.addEventListener("click",function(e){g="http://api.soundcloud.com/tracks.json?&client_id=cc7f901025ad59c9e06ea0f140fd6e58&genres="+e.source.title,networkLoad.netCheck(g),o.close()}),c.addEventListener("click",function(e){g="http://api.soundcloud.com/tracks.json?&client_id=cc7f901025ad59c9e06ea0f140fd6e58&genres="+e.source.title,networkLoad.netCheck(g),o.close()})},exports.playlistBuild=function(e){var t=new dataLoad,a=Titanium.UI.createAnimation();a.left=0,a.duration=300;var o=0,i=e,r=i.length-1,n=Ti.UI.createWindow({backgroundColor:"#000",fullscreen:!0}),d=Ti.Media.createAudioPlayer({url:i[o].stream,allowBackground:!0,preload:!0}),l=Ti.UI.createProgressBar({top:"66%",width:"90%",height:"40dp",min:0,max:i[o].duration/1e3,value:0,tintColor:"#FF6600"}),s=Ti.UI.createButton({bottom:"9%",backgroundImage:"images/pause1.png"}),u=Ti.UI.createButton({bottom:"10%",left:"12%",backgroundImage:"images/back1.png"}),c=Ti.UI.createButton({top:"1%",left:"2%",backgroundImage:"images/return_arrow.png"}),g=Ti.UI.createButton({title:"ADD TO FAVORITES",font:{fontSize:"22dp"},top:"71%",height:"5%",color:"#FF6600"}),p=Ti.UI.createButton({bottom:"10%",right:"12%",backgroundImage:"images/next1.png"}),f=Ti.UI.createSlider({bottom:"5%",min:0,max:100,width:"65%",value:80,tintColor:"#FF6600"}),m=Ti.UI.createImageView({height:420,width:420,top:"10%",image:i[o].artwork});console.log(m.image),console.log(i[o].artwork);var T=Ti.UI.createLabel({text:i[o].title,font:{fontFamily:"Roboto",fontSize:"30dp"},color:"#fff",backgroundColor:"#000",top:"55%"}),k=Ti.UI.createLabel({text:i[o].user,font:{fontFamily:"Roboto",fontSize:"20dp"},color:"#fff",backgroundColor:"#000",top:"63%"});d.addEventListener("progress",function(e){l.value=Math.round(e.progress/1e3)}),f.addEventListener("change",function(e){d.volume=e.value/100}),s.addEventListener("click",function(){d.paused?(s.backgroundImage="images/pause1.png",d.play()):d.playing&&(s.backgroundImage="images/play1.png",d.pause())}),p.addEventListener("click",function(){o>=r?alert("Add more songs to playlist!"):d.playing?"android"==osname?d.release():d.stop():d.paused&&("android"==osname?d.release():(s.backgroundImage="images/pause1.png",d.stop()))}),u.addEventListener("click",function(){0===o?u.enabled=!1:d.playing?(o-=2,"android"==osname?d.release():d.stop()):d.paused&&(o-=2,"android"==osname?d.release():(s.backgroundImage="images/pause1.png",d.stop()))}),d.addEventListener("change",function(e){Ti.API.info("State: "+e.description+" ("+e.state+")"),0!==o&&(u.enabled=!0)}),g.addEventListener("click",function(){t.create(i[o]),cloudLoad.cloudSave(i[o]),alert(i[o].title+"\nHas been added to your favorites!")}),d.addEventListener("change",function(e){console.log(r,o),o>r&&0==e.state?alert("End of playlist! Continue or exit!"):7===e.state&&o>=0&&r>o?(console.log("SONG COMPLETED!!!"),"android"==osname?d.release():d.stop(),o+=1,d.url=i[o].stream,m.image=i[o].artwork,T.text=i[o].title,k.text=i[o].user,n.remove(m),n.remove(T),n.remove(k),n.add(k),n.add(T),n.add(m),console.log(i[o].artwork),d.play()):7===e.state&&0>=o&&("android"==osname?d.release():d.stop(),o=0,d.url=i[o].stream,m.image=i[o].artwork,T.text=i[o].title,k.text=i[o].user,n.remove(m),n.remove(T),n.remove(k),n.add(k),n.add(T),n.add(m),d.play())}),c.addEventListener("click",function(){"android"==osname?d.release():d.playing&&d.pause(),n.close(),uiLoad.entryBuild()}),i[o].id||n.add(g),Ti.Gesture.addEventListener("orientationchange",function(){console.log(Ti.Gesture.orientation),3==Ti.Gesture.orientation||4==Ti.Gesture.orientation?(m.top="8%",m.width=350,m.height=350):(1==Ti.Gesture.orientation||2==Ti.Gesture.orientation)&&(m.top="10%",m.width=420,m.height=420)}),n.add(m),n.add(f),n.add(l),n.add(k),n.add(T),n.add(c),n.add(p),n.add(u),n.add(s),n.add(d),n.open(a),d.start(),l.show()};